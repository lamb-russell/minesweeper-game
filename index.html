<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minesweeper Game</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            padding: 10px;
        }

        .instructions {
            max-width: 600px;
            background-color: #ffffff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .instructions h2 {
            margin: 0 0 10px;
        }

        .instructions p {
            margin: 5px 0;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 1px;
            width: 90vw;
            height: 90vw;
            max-width: 600px;
            max-height: 600px;
        }

        .cell {
            background-color: #fff;
            border: 1px solid #999;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1rem;
            font-weight: bold;
        }

        .cell.revealed {
            background-color: #e0e0e0;
            cursor: default;
        }

        .cell.mine {
            background-color: #f06e6e;
        }

        .cell.flag {
            background-color: #ffc107;
        }

        .cell.questionmark {
            background-color: #ff9a9a;
        }

        .controls {
            margin: 20px 0;
            display: flex;
            gap: 10px;
        }

        .button {
            padding: 10px 20px;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
        }

        .button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="instructions">
        <h2>How to Play Minesweeper</h2>
        <p>💣 <strong>Goal:</strong> Reveal all cells that are not mines without clicking on any mine.</p>
        <p>💡 <strong>How to Play:</strong></p>
        <ul>
            <li><strong>Left-Click:</strong> Reveal a cell. If it's a number, it shows the count of adjacent mines. If it's a mine, you lose!</li>
            <li><strong>Right-Click:</strong> Mark a cell as a flag (potential mine) or a question mark.</li>
            <li>Reveal all non-mine cells or correctly flag all mines to win the game.</li>
        </ul>
    </div>
    <div class="controls">
        <button class="button" id="resetButton">Reset</button>
    </div>
    <div class="board"></div>
    <script>
        const board = document.querySelector('.board');
        const resetButton = document.getElementById('resetButton');
        let mineField;
        let totalMines = 10;
        let correctlyFlaggedMines = 0;

        function createMinefield(height, width, mines) {
            const totalCells = height * width;
            const mineArray = Array(mines).fill('mine').concat(Array(totalCells - mines).fill('.'));
            mineArray.sort(() => Math.random() - 0.5);

            mineField = [];
            for (let i = 0; i < height; i++) {
                mineField.push(mineArray.slice(i * width, i * width + width));
            }
            correctlyFlaggedMines = 0; // Reset the flag count
        }

        function renderBoard() {
            board.innerHTML = '';
            for (let i = 0; i < mineField.length; i++) {
                for (let j = 0; j < mineField[i].length; j++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.dataset.x = i;
                    cell.dataset.y = j;

                    // Left click to reveal
                    cell.addEventListener('click', () => revealCell(i, j));

                    board.appendChild(cell);
                }
            }
        }

        function countAdjacentMines(x, y) {
            let minesCount = 0;
            for (let i = x - 1; i <= x + 1; i++) {
                for (let j = y - 1; j <= y + 1; j++) {
                    if (i < 0 || i >= mineField.length || j < 0 || j >= mineField[0].length) continue;
                    if (mineField[i][j] === 'mine') minesCount++;
                }
            }
            return minesCount;
        }

        function revealCell(x, y) {
            const cellIndex = x * mineField[0].length + y;
            const cell = board.children[cellIndex];

            if (cell.classList.contains('revealed') || cell.classList.contains('flag')) return;

            cell.classList.add('revealed');

            if (mineField[x][y] === 'mine') {
                cell.classList.add('mine');
                alert('Game Over!');
                revealAllMines();
                return;
            }

            const adjacentMines = countAdjacentMines(x, y);

            if (adjacentMines > 0) {
                cell.textContent = adjacentMines;
            } else {
                const queue = [[x, y]];
                while (queue.length > 0) {
                    const [cx, cy] = queue.shift();
                    for (let i = cx - 1; i <= cx + 1; i++) {
                        for (let j = cy - 1; j <= cy + 1; j++) {
                            if (
                                i >= 0 &&
                                i < mineField.length &&
                                j >= 0 &&
                                j < mineField[0].length
                            ) {
                                const adjCellIndex = i * mineField[0].length + j;
                                const adjCell = board.children[adjCellIndex];
                                if (!adjCell.classList.contains('revealed') && !adjCell.classList.contains('flag')) {
                                    adjCell.classList.add('revealed');
                                    const adjMines = countAdjacentMines(i, j);
                                    if (adjMines > 0) {
                                        adjCell.textContent = adjMines;
                                    } else {
                                        queue.push([i, j]);
                                    }
                                }
                            }
                        }
                    }
                }
            }

            checkWinCondition();
        }

        function revealAllMines() {
            for (let i = 0; i < mineField.length; i++) {
                for (let j = 0; j < mineField[i].length; j++) {
                    if (mineField[i][j] === 'mine') {
                        const cellIndex = i * mineField[0].length + j;
                        const cell = board.children[cellIndex];
                        cell.classList.add('mine');
                    }
                }
            }
        }

        board.addEventListener('contextmenu', (event) => {
            event.preventDefault();
            const cell = event.target;
            const x = parseInt(cell.dataset.x);
            const y = parseInt(cell.dataset.y);

            if (cell.classList.contains('cell') && !cell.classList.contains('revealed')) {
                if (cell.classList.contains('flag')) {
                    cell.classList.remove('flag');
                    cell.textContent = ''; // Remove the emoji
                    cell.classList.add('questionmark');
                    cell.textContent = '❓'; // Add the question mark emoji
                    if (mineField[x][y] === 'mine') correctlyFlaggedMines--;
                } else if (cell.classList.contains('questionmark')) {
                    cell.classList.remove('questionmark');
                    cell.textContent = ''; // Remove the emoji
                } else {
                    cell.classList.add('flag');
                    cell.textContent = '🚩'; // Add the flag emoji
                    if (mineField[x][y] === 'mine') correctlyFlaggedMines++;
                }
            }

            checkWinCondition();
        });


        function checkWinCondition() {
            if (correctlyFlaggedMines === totalMines) {
                alert('Congratulations! You win!');
            }
        }

        function game() {
            createMinefield(10, 10, 10);
            renderBoard();
        }

        resetButton.addEventListener('click', () => {
            game(); // Restart the game
        });

        // Start the game when the page loads
        window.onload = game;
    </script>
</body>
</html>
